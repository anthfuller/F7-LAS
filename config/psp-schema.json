{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://f7las.ai/schema/psp-schema.json",
  "title": "F7-LAS Prompt Security Profile (PSP)",
  "type": "object",

  "required": [
    "psp_id",
    "agent_name",
    "role",
    "version",
    "risk_tier",
    "approved_by",
    "change_ticket",
    "approval_date",
    "scope",
    "forbidden_actions",
    "escalation_rules",
    "approved_rag_sources",
    "logging_requirements"
  ],

  "properties": {
    "psp_id": {
      "type": "string",
      "description": "Unique PSP identifier (e.g., Coordinator-PSP-001)"
    },
    "agent_name": {
      "type": "string",
      "description": "Agent name (coordinator, investigator, remediator)"
    },
    "role": {
      "type": "string",
      "description": "High-level agent function"
    },
    "version": {
      "type": "string",
      "description": "PSP version identifier (e.g., v1.0)"
    },
    "risk_tier": {
      "type": "string",
      "enum": ["low", "medium", "medium-low", "high", "critical"],
      "description": "Overall risk tier for this agent"
    },
    "approved_by": {
      "type": "string",
      "description": "Reviewer or group that approved this PSP"
    },
    "change_ticket": {
      "type": "string",
      "description": "CAB or change reference"
    },
    "approval_date": {
      "type": "string",
      "format": "date",
      "description": "Last PSP approval date"
    },
    "owner_team": {
      "type": "string",
      "description": "Team maintaining this agent"
    },

    "scope": {
      "type": "array",
      "description": "Allowed tasks or operational scope",
      "items": { "type": "string" }
    },
    "out_of_scope": {
      "type": "array",
      "description": "Explicitly forbidden task domains",
      "items": { "type": "string" }
    },

    "forbidden_actions": {
      "type": "array",
      "description": "Actions that must never be performed",
      "items": { "type": "string" }
    },

    "escalation_rules": {
      "type": "array",
      "description": "When HITL is required",
      "items": { "type": "string" }
    },

    "approved_rag_sources": {
      "type": "array",
      "description": "Allowed RAG search collections",
      "items": { "type": "string" }
    },
    "disallowed_domains": {
      "type": "array",
      "description": "Data domains that must never be accessed",
      "items": { "type": "string" }
    },

    "input_validation_rules": {
      "type": "array",
      "description": "Validation rules for user inputs",
      "items": { "type": "string" }
    },
    "output_format_rules": {
      "type": "array",
      "description": "Formatting constraints for agent output",
      "items": { "type": "string" }
    },

    "logging_requirements": {
      "type": "array",
      "description": "Required logging fields (Layer 7 observability)",
      "items": { "type": "string" }
    },
    "telemetry_fields": {
      "type": "array",
      "description": "Additional telemetry fields for cross-agent correlation",
      "items": { "type": "string" }
    },

    "related_artifacts": {
      "type": "object",
      "description": "Cross-links to F7-LAS controls",
      "properties": {
        "implementation_profile_ref": { "type": "string" },
        "rag_policy_ref": { "type": "string" },
        "tool_policy_ref": { "type": "string" },
        "sandbox_policy_ref": { "type": "string" },
        "slos_ref": { "type": "string" }
      },
      "additionalProperties": false
    },

    "notes": {
      "type": "string",
      "description": "Optional free-form notes"
    }
  },

  "additionalProperties": false
}
