# F7-LAS Layer 5 â€“ deny terminate_instance in production when time_ok == false

main = rule {
  request := input.request

  action := request.action
  env := request.environment
  time_ok := request.current_time_ok_for_change

  # Deny only when all three conditions are met
  not (action == "terminate_instance" && env == "production" && time_ok == false)
}
